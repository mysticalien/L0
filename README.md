# L0 Orders Service

---

### üé• –í–∏–¥–µ–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞:

https://github.com/user-attachments/assets/963ffffa-52b5-42e1-a032-ff6b09ed4db9

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**L0 Orders Service** ‚Äî —ç—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Kafka** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö **PostgreSQL** –∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –°–µ—Ä–≤–∏—Å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö –ø–æ –∏—Ö `order_id`, –∞ —Ç–∞–∫–∂–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞.

<p align="center">
  <img src="/images/ui_1.png" alt="Orders Service" width="600" />
</p>

---

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ **Kafka** –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–∫–∞–∑–∞—Ö —á–µ—Ä–µ–∑ —Ç–æ–ø–∏–∫ `orders`.
2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –≤ **PostgreSQL**.
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞.
5. –ó–∞–ø—É—Å–∫ **HTTP-—Å–µ—Ä–≤–µ—Ä–∞** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ ID –∑–∞–∫–∞–∑–∞ —á–µ—Ä–µ–∑ REST API.
6. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤** –∏ **—Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–æ–≤**.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- **Kafka Consumer**: –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–æ–ø–∏–∫ `orders`, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.
- **PostgreSQL**: –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö.
- **–ö—ç—à**: In-memory —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
- **HTTP-—Å–µ—Ä–≤–µ—Ä**: –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–µ —á–µ—Ä–µ–∑ REST API.
- **Redpanda Console**: UI –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Kafka.

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

- **Go**: –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞.
- **Kafka**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∑–∞–∫–∞–∑–∞—Ö.
- **PostgreSQL**: –•—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤.
- **Docker**: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.
- **Chi**: HTTP —Ä–æ—É—Ç–∏–Ω–≥.
- **WRK** –∏ **Vegeta**: –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone git@github.com:mysticalien/L0.git
cd L0
```

### 2. –ó–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é Makefile

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

```bash
make all
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:
- –°–æ–±–µ—Ä–µ—Ç Go-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
- –ó–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ Docker Compose.
- –ó–∞–ø—É—Å—Ç–∏—Ç HTTP-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É `8080`.
- –ó–∞–ø—É—Å—Ç–∏—Ç Kafka producer –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è.

### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
make docker-down
```

---

## –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–°–µ—Ä–≤–∏—Å –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö. –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å http://localhost:8080, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: –ü–æ–∫–∞–∑ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –∏ –ø–æ–∏—Å–∫ –∑–∞–∫–∞–∑–∞ –ø–æ ID.
- –ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–∞: –í–≤–µ–¥–∏—Ç–µ order_uid –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–∫–∞–∑–µ.
- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–∞: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ, —Ç–æ–≤–∞—Ä–∞—Ö –∏ –æ–ø–ª–∞—Ç–µ –∑–∞–∫–∞–∑–∞.
–ü—Ä–∏–º–µ—Ä —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

<p align="center">
  <img src="/images/ui.png" alt="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å" width="600" />
</p>

<p align="center">
  <img src="/images/ui_2.png" alt="–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ id –∑–∞–∫–∞–∑–∞" width="600" />
</p>

## –ö–æ–º–∞–Ω–¥—ã Makefile

- `make all`: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞, –≤–∫–ª—é—á–∞—è Kafka, PostgreSQL, –ø—Ä–æ–¥—é—Å–µ—Ä–∞ –∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è.
- `make create-topic`: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–ø–∏–∫–∞ Kafka –≤—Ä—É—á–Ω—É—é.
- `make build`: –°–±–æ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–æ–¥—é—Å–µ—Ä–∞.
- `make docker-up`: –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ Docker Compose.
- `make run-main`: –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.
- `make run-producer`: –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥—é—Å–µ—Ä–∞ Kafka.
- `make docker-down`: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.
- `make clean`: –û—á–∏—Å—Ç–∫–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
- `make redpanda-console`: –ó–∞–ø—É—Å–∫ Redpanda Console –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Kafka.
- `make test`: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤.
- `make test_wrk`: –°—Ç—Ä–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Ç–∏–ª–∏—Ç–æ–π wrk.
- `make test_vegeta`: –°—Ç—Ä–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Ç–∏–ª–∏—Ç–æ–π vegeta.

---

## API

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–µ –ø–æ ID**:

```bash
GET http://localhost:8080/order/{id}
```

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:

```bash
curl http://localhost:8080/order/b563feb7b2b84b6test
```

2. **–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ —á–µ—Ä–µ–∑ Kafka**:

Producer –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–æ–ø–∏–∫ `orders` —á–µ—Ä–µ–∑ Kafka:

```bash
make run-producer
```

---

## –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã

–ê–≤—Ç–æ—Ç–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∫—ç—à–∞, —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ Kafka. –î–ª—è –∏—Ö –∑–∞–ø—É—Å–∫–∞:

```bash
make test
```

–¢–µ—Å—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `tests/`.

<p align="center">
  <img src="/images/test.png" alt="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã" width="600" />
</p>

---

## –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç—ã

### WRK:

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç–∞ –¥–ª—è HTTP-—Å–µ—Ä–≤–µ—Ä–∞:

```bash
make test_wrk
```

<p align="center">
  <img src="/images/wrk_test.png" alt="WRK —Ç–µ—Å—Ç—ã" width="600" />
</p>

### Vegeta:

–ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```bash
make test_vegeta
```

<p align="center">
  <img src="/images/vegeta_test.png" alt="Vegeta —Ç–µ—Å—Ç—ã" width="600" />
</p>

---

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ —Å –ø–æ–º–æ—â—å—é –ø–∞–∫–µ—Ç–∞ `slog` –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤ (debug, info, warn, error).

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `cmd/`: –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞ –∏ –ø—Ä–æ–¥—é—Å–µ—Ä–∞ Kafka.
- `internal/`: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
    - `cache/`: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏.
    - `config/`: –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ñ–∏–≥–æ–≤.
    - `kafka/`: –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π Kafka.
    - `model/`: –ü–∞—Ä—Å–∏–Ω–≥ JSON —Ñ–∞–π–ª–∞.
    - `handlers/`: HTTP-—Å–µ—Ä–≤–µ—Ä –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.
    - `storage/`: –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL.
    - `logger/`: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é `slog`.
- `config/`: Config —Ñ–∞–π–ª.
- `data/`: –ú–æ–¥–µ–ª–∏ json –∏ sql.
- `scripts/`: –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Kafka –∏ Postgres.
- `static/`: UI.
- `Dockerfile`: –§–∞–π–ª –¥–ª—è —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞.
- `docker-compose.yml`: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ Docker Compose.
- `Makefile`: –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞.
- `tests/`: –¢–µ—Å—Ç—ã.

---
